[build]
builder = "nixpacks"

[nixpacks]
# Specify Python 3.11 and Node.js for mixed stack
packages = ["python311", "python311Packages.pip"]
commands = ["pip install -r backend/requirements.txt", "npm install"]

[deploy]
startCommand = "gunicorn -w 4 -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:$PORT backend.main:app --timeout 120"
healthcheckPath = "/system/health"
healthcheckTimeout = 100

[environment]
PYTHONUNBUFFERED = "true"
ENVIRONMENT = "production"
# Railway will auto-inject DATABASE_URL and REDIS_URL when you link services
# GEE_SERVICE_ACCOUNT_FILE is read from Railway project secrets
